<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yuehai.learn.english.mapper.WordMarkMapper">

    <resultMap id="wordMarkResultMap" type="com.yuehai.learn.english.entity.WordMarkEntity">
        <result column="uid" property="id" jdbcType="BIGINT"/>
        <result column="user_phone" property="userPhone" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
        <result column="mark_count" property="markCount" jdbcType="INTEGER"/>
    </resultMap>

    <sql id="selectWordMarkSql">
        select uid, user_phone, word_id, create_time, update_time, mark_count
        from tb_user_word_mark</sql>

    <select id="selectWordMark" resultMap="wordMarkResultMap">
        <include refid="selectWordMarkSql"/>
        where user_phone = #{userPhone}
        and word_id = #{wordId}
    </select>

    <select id="selectWordMarks" resultMap="wordMarkResultMap">
        <include refid="selectWordMarkSql"/>
        where user_phone = #{userPhone}
        order by mark_count desc
    </select>

    <insert id="insertWordMark">
        insert into tb_user_word_mark(user_phone, word_id, mark_count)
        values (#{userPhone}, #{wordId}, #{markCount})
    </insert>

    <update id="updateWordMark">
        update tb_user_word_mark
        set mark_count = #{markCount}
        where uid = #{id}
    </update>

    <delete id="deleteWordMarkByWordId">
        delete
        from tb_user_word_mark
        where word_id = #{id}
    </delete>

    <delete id="deleteWordMarkByWordIds" parameterType="Long">
        delete
        from tb_user_word_mark
        where word_id in
        <foreach collection="array" item="id" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper>